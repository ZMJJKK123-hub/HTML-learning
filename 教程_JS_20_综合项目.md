# JavaScript 第 20 步：综合项目

配套演示：HTMLlearning/20_js_final_project.html

## 目标
- 将前面学过的主题/状态/异步/组件/可访问性整合在一页。
- 实现主题切换、Tabs、任务列表、表单校验、异步数据加载、Toast 提示。
- 保持状态集中、事件委托、可访问性（ARIA、焦点、aria-live）。

---

## 页面模块
1) 主题切换：按钮切换 light/dark/system，localStorage 记忆。
2) Tabs 信息中心：委托 + ARIA，切换面板；任务列表在任务面板内。
3) 表单（报名）：校验姓名/邮箱/路线，成功与失败均有 Toast 提示。
4) 异步数据：加载/失败状态提示，列表展示；错误时弹 Toast。
5) Toast：aria-live 提示；成功/错误不同样式。

---

## 关键实现要点
- 主题：`document.documentElement.dataset.theme`，localStorage 记忆。
- Tabs：tabList 上委托 click；`aria-selected` 与 panel active 同步。
- 任务列表：state 数组 + render；删除使用委托。
- 表单：`preventDefault`，同步状态和 Toast；校验必填与邮箱格式。
- 异步：fakeFetch 模拟成功/失败；加载中/成功/错误三态反馈。
- Toast：动态创建并自动移除；aria-live 提示屏幕阅读器。

---

## 自主加分练习
1) 主题切换：加“跟随系统”并在 system 模式下监听 `matchMedia('(prefers-color-scheme: dark)')` 变化。
2) Tabs：加入键盘左右导航与 Enter/Space 激活；为当前 tab 设置 `tabindex="0"`，其他 -1。
3) 表单：增加字段错误高亮（为 input 添加 error 类），并在 Toast 中显示具体缺失项。
4) 异步：添加“刷新”按钮与重试次数提示；将 fakeFetch 抽出为模块并支持超时（Promise.race）。
5) Toast：支持 info/warn 类型，增加“清空全部”按钮；将 toast 管理抽到独立模块。

---

## 可访问性检查清单
- 交互控件可聚焦；tab 键顺序合理。
- 模块状态（加载/错误/成功）有文本提示；错误信息可读。
- Toast 使用 `aria-live="polite" aria-atomic="true"`。
- 表单输入有可见状态反馈（错误时高亮）。

---

## 工程化思考
- 若用构建工具：将页面拆分为多个模块（theme/tabs/tasks/form/data/toast），通过动态导入加载次级功能。
- 结合第 19 步：为重型逻辑做代码分割；在渲染高峰使用 requestIdleCallback 分批更新。
- 部署前：启用 Lint/Format、压缩/指纹、缓存策略（Cache-Control/ETag）。
